/**
 * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ "–ë–æ–ª—å—à–∞—è –ø—è—Ç—ë—Ä–∫–∞ (Big Five)": –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ 3‚Äì5
 * –ë–ª–æ–∫–∏: –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è, –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ù–µ–π—Ä–æ—Ç–∏–∑–º (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)
 * –§–æ—Ä–º–∞—Ç: rating 1‚Äì5, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ ‚Äî ne8
 */

import { connectDatabase, closeDatabase, query } from '@/shared/database/connection.js';
import { SurveyService, SurveyRepository } from '@/features/surveys/index.js';
import { UpdateSurveyDto, CreateSurveyDto } from '@/shared/types/survey.js';
import { pool } from '@/shared/database/connection.js';

const scale = {
  min: 1,
  max: 5,
  step: 1,
  minLabel: '–ù–µ —Å–æ–≥–ª–∞—Å–µ–Ω',
  maxLabel: '–°–æ–≥–ª–∞—Å–µ–Ω'
} as const;

function buildAllSectionsQuestions() {
  // –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–ª–æ–∫–∏ (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º): –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å (op1-op8), –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å (co1-co8)
  const openness = [
    { id: 'op1', title: '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ–ø—Ä–∏–≤—ã—á–Ω—ã.' },
    { id: 'op2', title: '–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ –æ–¥–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º.' },
    { id: 'op3', title: '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–∑—É—á–∞—Ç—å —Å–º–µ–∂–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –∏–ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å –∑–Ω–∞–Ω–∏—è –≤–Ω–µ —Ç–µ–∫—É—â–µ–π —Ä–æ–ª–∏.' },
    { id: 'op4', title: '–Ø –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–∂—É –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º.' },
    { id: 'op5', title: '–Ø —á—É–≤—Å—Ç–≤—É—é —Å–∫—É–∫—É, –∫–æ–≥–¥–∞ –≤—Å—ë –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –±–µ–∑ –Ω–æ–≤—ã—Ö –∏–¥–µ–π.' },
    { id: 'op6', title: '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –º–µ—Ç–æ–¥–∏–∫–µ.' },
    { id: 'op7', title: '–Ø —Å—Ç–∞—Ä–∞—é—Å—å –≤–∏–¥–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤ –ª—é–±—ã—Ö —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.' },
    { id: 'op8', title: '–õ—é–¥–∏ —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç –º–æ–∏ –ø–æ–¥—Ö–æ–¥—ã –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–º–∏.' }
  ].map(q => ({ id: q.id, type: 'rating' as const, title: q.title, required: true, section: 'openness', scale }));

  const conscientiousness = [
    { id: 'co1', title: '–Ø –≤—Å–µ–≥–¥–∞ —Å—Ç–∞—Ä–∞—é—Å—å –¥–æ–≤–æ–¥–∏—Ç—å –∑–∞–¥–∞—á–∏ –¥–æ –∫–æ–Ω—Ü–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∑–∞–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è.' },
    { id: 'co2', title: '–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ç–æ—á–Ω–æ –∏ –≤ —Å—Ä–æ–∫.' },
    { id: 'co3', title: '–Ø —Ä–µ–¥–∫–æ –∑–∞–±—ã–≤–∞—é –æ —Å–≤–æ–∏—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞—Ö.' },
    { id: 'co4', title: '–Ø —Å–∫–ª–æ–Ω–µ–Ω —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã.' },
    { id: 'co5', title: '–ò–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è –ª—É—á—à–µ, —á–µ–º —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω—É.' },
    { id: 'co6', title: '–ö–æ–ª–ª–µ–≥–∏ –º–æ–≥—É—Ç –Ω–∞ –º–µ–Ω—è –ø–æ–ª–æ–∂–∏—Ç—å—Å—è –≤ –≤–∞–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö.' },
    { id: 'co7', title: '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ —á–µ–∫‚Äë–ª–∏—Å—Ç—É.' },
    { id: 'co8', title: '–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø–æ—Ä—è–¥–æ–∫ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–∂–µ –≤ –º–µ–ª–æ—á–∞—Ö.' }
  ].map(q => ({ id: q.id, type: 'rating' as const, title: q.title, required: true, section: 'conscientiousness', scale }));

  // –ù–æ–≤—ã–µ –±–ª–æ–∫–∏: –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è (ex1-ex8)
  const extraversion = [
    { id: 'ex1', title: '–Ø —á—É–≤—Å—Ç–≤—É—é –ø—Ä–∏–ª–∏–≤ —ç–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏ –æ–±—â–µ–Ω–∏–∏ —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏.' },
    { id: 'ex2', title: '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –≤—ã—Å—Ç—É–ø–∞—Ç—å –∏–ª–∏ –≤—ã—Ä–∞–∂–∞—Ç—å —Å–≤–æ—ë –º–Ω–µ–Ω–∏–µ –Ω–∞ —Å–æ–±—Ä–∞–Ω–∏—è—Ö.' },
    { id: 'ex3', title: '–Ø —á–∞—Å—Ç–æ –∏–Ω–∏—Ü–∏–∏—Ä—É—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤ –∫–æ–º–∞–Ω–¥–µ.' },
    { id: 'ex4', title: '–Ø —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è –∏—Å—Ç–æ—â—ë–Ω–Ω—ã–º –ø–æ—Å–ª–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è.' },
    { id: 'ex5', title: '–Ø –ª—é–±–ª—é –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ —Å–æ–±—ã—Ç–∏–π.' },
    { id: 'ex6', title: '–ú–Ω–µ –≤–∞–∂–Ω–æ –æ—â—É—â–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ–º–ø–∞ —Ä–∞–±–æ—Ç—ã.' },
    { id: 'ex7', title: '–Ø –ª–µ–≥–∫–æ –∑–∞–≤–æ–∂—É –∫–æ–Ω—Ç–∞–∫—Ç—ã –≤ –Ω–æ–≤–æ–π —Å—Ä–µ–¥–µ.' },
    { id: 'ex8', title: '–ò–Ω–æ–≥–¥–∞ –º–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –≤ —Ç–∏—à–∏–Ω–µ –∏ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ.' }
  ].map(q => ({ id: q.id, type: 'rating' as const, title: q.title, required: true, section: 'extraversion', scale }));

  // –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (ag1-ag8)
  const agreeableness = [
    { id: 'ag1', title: '–Ø –ª–µ–≥–∫–æ –Ω–∞—Ö–æ–∂—É –æ–±—â–∏–π —è–∑—ã–∫ –¥–∞–∂–µ —Å —Ç—Ä—É–¥–Ω—ã–º–∏ –∫–æ–ª–ª–µ–≥–∞–º–∏.' },
    { id: 'ag2', title: '–Ø —Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–º–æ—á—å, –∫–æ–≥–¥–∞ –≤–∏–∂—É, —á—Ç–æ —É –∫–æ–≥–æ‚Äë—Ç–æ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ —Ä–∞–±–æ—Ç–µ.' },
    { id: 'ag3', title: '–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –≤ –∫–æ–º–∞–Ω–¥–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –≥–∞—Ä–º–æ–Ω–∏—è.' },
    { id: 'ag4', title: '–ò–Ω–æ–≥–¥–∞ —è –ø—Ä—è–º–æ –≤—ã—Ä–∞–∂–∞—é –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–¥–µ—Ç—å –¥—Ä—É–≥–æ–≥–æ.' },
    { id: 'ag5', title: '–Ø —Å—Ç–∞—Ä–∞—é—Å—å —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –≤–µ—â–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞.' },
    { id: 'ag6', title: '–Ø —á—É–≤—Å—Ç–≤—É—é —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ, –∫–æ–≥–¥–∞ —É –∫–æ–ª–ª–µ–≥ –≤—Å—ë –ø–æ–ª—É—á–∞–µ—Ç—Å—è.' },
    { id: 'ag7', title: '–ú–Ω–µ –Ω–µ—Å–ª–æ–∂–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–æ—â–µ–Ω–∏—è, –µ—Å–ª–∏ —è –±—ã–ª –Ω–µ–ø—Ä–∞–≤.' },
    { id: 'ag8', title: '–ú–Ω–µ –≤–∞–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –¥–ª—è –∫–æ–º–∞–Ω–¥—ã, –¥–∞–∂–µ —Å–≤–µ—Ä—Ö —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π.' }
  ].map(q => ({ id: q.id, type: 'rating' as const, title: q.title, required: true, section: 'agreeableness', scale }));

  // –ù–µ–π—Ä–æ—Ç–∏–∑–º / –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (ne1-ne8)
  const neuroticism = [
    { id: 'ne1', title: '–Ø —á–∞—Å—Ç–æ –≤–æ–ª–Ω—É—é—Å—å –∏–∑‚Äë–∑–∞ –º–µ–ª–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π.' },
    { id: 'ne2', title: '–ú–Ω–µ —Ç—è–∂–µ–ª–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–≤–ª–µ—á—å—Å—è –æ—Ç —Ä–∞–±–æ—Ç—ã –≤ –∫–æ–Ω—Ü–µ –¥–Ω—è.' },
    { id: 'ne3', title: '–Ø —Å–ø–æ–∫–æ–π–Ω–æ —Ä–µ–∞–≥–∏—Ä—É—é –Ω–∞ –∫—Ä–∏—Ç–∏–∫—É.' },
    { id: 'ne4', title: '–Ø –Ω–µ—Ä–≤–Ω–∏—á–∞—é, –∫–æ–≥–¥–∞ –º–Ω–æ–≥–æ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–µ–Ω—è –æ–¥–Ω–æ–≥–æ.' },
    { id: 'ne5', title: '–Ø —Å–æ—Ö—Ä–∞–Ω—è—é —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –≤ —Å—Ç—Ä–µ—Å—Å–µ.' },
    { id: 'ne6', title: '–ö–æ–≥–¥–∞ —á—Ç–æ‚Äë—Ç–æ –∏–¥—ë—Ç –Ω–µ –ø–æ –ø–ª–∞–Ω—É, —è –ª–µ–≥–∫–æ —Å–±–∏–≤–∞—é—Å—å —Å –Ω–∞—Å—Ç—Ä–æ—è.' },
    { id: 'ne7', title: '–ú–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å–∫—Ä—ã–≤–∞—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –≤—Å—ë –∏–¥—ë—Ç –º–µ–¥–ª–µ–Ω–Ω–æ.' },
    { id: 'ne8', title: '–Ø –±—ã—Å—Ç—Ä–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–∏.' }
  ].map(q => ({ id: q.id, type: 'rating' as const, title: q.title, required: true, section: 'neuroticism', scale }));

  const questions = [...openness, ...conscientiousness, ...extraversion, ...agreeableness, ...neuroticism];

  // –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–µ–º nextQuestion –ø–æ –ø–æ—Ä—è–¥–∫—É
  for (let i = 0; i < questions.length - 1; i++) {
    (questions[i] as any).nextQuestion = questions[i + 1].id;
  }

  return { questions };
}

function buildSectionsMeta() {
  return [
    { id: 'openness', title: '–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∫ –æ–ø—ã—Ç—É', description: '–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–æ–≤–æ–º—É' },
    { id: 'conscientiousness', title: '–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å', description: '–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å' },
    { id: 'extraversion', title: '–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è', description: '–°–æ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å, —ç–Ω–µ—Ä–≥–∏—á–Ω–æ—Å—Ç—å, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å' },
    { id: 'agreeableness', title: '–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', description: '–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, —ç–º–ø–∞—Ç–∏—è, –∞–ª—å—Ç—Ä—É–∏–∑–º' },
    { id: 'neuroticism', title: '–ù–µ–π—Ä–æ—Ç–∏–∑–º (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)', description: '–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –ø–æ–¥ —Å—Ç—Ä–µ—Å—Å–æ–º' }
  ];
}

async function updateBigFiveAddBlocks(): Promise<void> {
  await connectDatabase();

  // –ò—â–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–ø—Ä–æ—Å Big Five
  const res = await query(
    `SELECT id, metadata FROM surveys WHERE title ILIKE $1 OR ($2 = ANY(tags)) LIMIT 1`,
    ['%–ë–æ–ª—å—à–∞—è –ø—è—Ç—ë—Ä–∫–∞%', 'big-five']
  );

  const { questions } = buildAllSectionsQuestions();
  const logic = { startQuestion: 'op1', endPoints: ['ne8'] } as const;
  const sections = buildSectionsMeta();

  const surveyRepository = new SurveyRepository(pool);
  const surveyService = new SurveyService(surveyRepository);

  if (res.rows.length === 0) {
    // –ï—Å–ª–∏ –æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞–µ–º –µ–≥–æ —Å—Ä–∞–∑—É —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Å–µ–∫—Ü–∏–π
    const dto: CreateSurveyDto = {
      title: '–ë–æ–ª—å—à–∞—è –ø—è—Ç—ë—Ä–∫–∞ (Big Five)',
      description:
        '–û—Ü–µ–Ω–∫–∞ –ø—è—Ç–∏ –∫–ª—é—á–µ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–Ω—ã—Ö —á–µ—Ä—Ç: –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å, –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å, –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è, –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ù–µ–π—Ä–æ—Ç–∏–∑–º.',
      questions,
      logic,
      settings: { allowBack: true, showProgress: true, savePartialResults: true },
      metadata: {
        category: 'personality',
        estimatedDuration: 15,
        author: 'System',
        tags: ['big-five', 'personality', 'v1.1.0'],
        version: '1.1.0',
        sections
      }
    };
    await surveyService.createSurvey(dto);
    console.log('‚úÖ Big Five —Å–æ–∑–¥–∞–Ω (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ 40 –≤–æ–ø—Ä–æ—Å–æ–≤)');
  } else {
    const surveyId: string = res.rows[0].id;
    const existingMeta = res.rows[0].metadata || {};

    const updateDto: UpdateSurveyDto = {
      questions,
      logic,
      metadata: {
        ...existingMeta,
        sections,
        version: '1.1.0',
        tags: Array.isArray(existingMeta.tags)
          ? Array.from(new Set([...(existingMeta.tags as string[]), 'v1.1.0']))
          : ['v1.1.0']
      },
      description: '–û—Ü–µ–Ω–∫–∞ –ø—è—Ç–∏ –∫–ª—é—á–µ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–Ω—ã—Ö —á–µ—Ä—Ç: –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å, –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å, –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è, –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ù–µ–π—Ä–æ—Ç–∏–∑–º.'
    };

    const updated = await surveyService.updateSurvey(surveyId, updateDto);
    console.log('‚úÖ Big Five –æ–±–Ω–æ–≤–ª—ë–Ω –¥–æ 40 –≤–æ–ø—Ä–æ—Å–æ–≤:', { id: updated.id });
  }
}

if (import.meta.url === `file://${process.argv[1]}`) {
  updateBigFiveAddBlocks()
    .then(() => closeDatabase())
    .then(() => {
      console.log('üéâ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Big Five –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
      process.exit(0);
    })
    .catch((err) => {
      console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Big Five:', err);
      closeDatabase().finally(() => process.exit(1));
    });
}

export { updateBigFiveAddBlocks };


